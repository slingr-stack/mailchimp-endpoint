---
title: MailChimp endpoint
keywords: 
last_updated: July 31, 2017
tags: []
summary: "Detailed description of the API of the MailChimp endpoint."
---

## Overview

The MailChimp endpoint allows to sync email activity and campaign stats with your database, manage lists, view and 
control automation workflows, and test different calls and endpoints before pushing to production.

Some of the features are:

- Authentication
- Shortcuts for the REST API
- Helpers to convert date times

In most cases you will be using the provided shortcuts to access the API. For example, you could use the REST API
directly by doing an HTTP request like this:

```js
var res = app.endpoints.mailchimp.get('/lists');
```

However you probably want to use the shortcuts:

```js
var res = app.endpoints.mailchimp.lists.get();
```

These shortcuts are based on the [Mailchimp REST API](http://developer.mailchimp.com/documentation/mailchimp/reference/overview/).
You can see more information about that in the [shortcuts section](#shortcuts).

## Quick start

One common integration case with Mailchimp is the management of lists. For example, when a you add a new contact to your
app you might want to add a member to a list:

```js
var res = app.endpoints.mailchimp.lists.members.post(defaultListId, {
  email_address: record.field('email').val(),
  status: record.field('subscribed').val() ? 'subscribed' : 'unsubscribed',
  merge_fields: {
    FNAME: record.field('firstName').val(),
    LNAME: record.field('lastName').val()
  }
});
record.field('mailchimpSubscriberId').val(res.data.unique_email_id);
sys.data.save(record);
```

Additionally, if a user unsubscribes, you can remove catch the webhook with a listener and mark the contact as 
unsubscribed:

```js
var webhook = event.data.body;
sys.logs.info('Processing Mailchimp webhook of type ['+webhook.type+']');
if (webhook.type == 'unsubscribe') {
  var contact = sys.data.findOne('contacts', {mailchimpSubscriberId: webhook.data.id});
  if (contact) {
    contact.field('subscribed').val(false);
    sys.data.save(contact);
  }    
}
```

## Configuration

First you will need to setup an account in MailChimp. Then you will be able to configure the endpoint you will
need to generate an API key. You can find more information about that [here](http://kb.mailchimp.com/integrations/api-integrations/about-api-keys).

### API key

This is the API key generated by following the process [here](http://kb.mailchimp.com/integrations/api-integrations/about-api-keys).
Just copy the generated API key to this field.

### Webhook URL

This is the URL you should configure for webhooks in Mailchimp. Notice that you need to configure the webhook URL on 
each MailChimp list. Please refer to the [webhooks documentation](https://mailchimp.com/developer/marketing/guides/sync-audience-data-webhooks/) 
for more information on how to configure them.

## Javascript API

The Javascript API of the Mailchimp endpoint has three pieces:

- **HTTP request**: this allows to make regular HTTP requests like `GET`, `POST` or `PUT` to the API.
- **Shortcuts**: these are helpers to make HTTP request to the API in a more convenient way.
- **Date helpers**: allow to easily convert dates from/to Mailchimp so they can be used easily in SLINGR.

### HTTP requests

You can make `GET`, `POST`, `PUT`, and `DELETE` request to the 
[MailChimp API](http://developer.mailchimp.com/documentation/mailchimp/reference/overview/) like this:

```js
var lists = app.endpoints.mailchimp.get('/lists');
var newCampaignFolder = app.endpoints.mailchimp.post('/campaign-folders', { "name": "NewFolderName" });
```

Please take a look at the documentation of the [HTTP endpoint]({{site.baseurl}}/endpoints_http.html#javascript-api)
for more information.

### Shortcuts

Instead of having to use the generic HTTP methods, you can make use of the shortcuts provided in the endpoint. These
shortcuts follow these rules:

- **Path sections get converted to namespaces**: for example if the method is GET `~/ecommerce/stores/{store_id}/carts/{cart_id}` 
  it is converted to `app.endpoints.mailchimp.ecommerce.stores.carts.get(storeId, cartIdid2)`. 
- **If they have dashes, we should convert them to camel case**: `~/file-manager/files` is converted to 
  `app.endpoints.mailchimp.fileManager.files.get()`. 
- **HTTP method is appended at the end of the method**: for example if the method is `GET`, you will see a method with 
  the suffix `.get(...)`. For example `GET ~/campaigns/{campaign_id}` will become `app.endpoints.mailchimp.campaigns.get(id)`. 
  This is the mapping of names:
  - `GET`: `get`
  - `POST`: `create`
  - `PUT`: `update`
  - `PATCH`: `update`
  - `DELETE`: `delete`
- **Path variables become method parameters**: if the method has variables in the path, they will become parameters for 
  the method. For example `GET ~/conversations/{conversation_id}/messages/{message_id}` will become 
  `app.endpoints.mailchimp.conversations.messages.get(conversationId, messageId)`.
- **Additional parameters or body are sent in the last param as JSON**: if the method accepts more parameters or it 
  allows to send a body, that will be sent in the last parameter. For example the method `POST ~/campaigns/{campaign_id}/feedback` 
  supports many query parameters, so it will become `app.endpoints.mailchimp.campaigns.feedback.post(campaignId, {...})`.
  
Here are some URLs of the REST API and their corresponding shortcut:

```js
// GET /campaigns
var res = app.endpoints.mailchimp.campaigns.get();

// GET /campaigns/{campaign_id}
var res = app.endpoints.mailchimp.campaigns.get(campaignId);

// GET /lists/{list_id}/members
var res = app.endpoints.mailchimp.lists.members.get(listId, params);

// POST /lists/{list_id}/members
var res = app.endpoints.mailchimp.lists.members.post(listId, body);
```

### Upload files

When uploading files it is possible to send the ID of a file in the SLINGR app and the endpoint will automatically
read and send it to MailChimp:

```js
var res = app.endpoints.mailchimp.fileManager.files.post({
  file_id: fileId, 
  name: 'test.png',
  folder_id: folderId
});
```

Where `file_id` is the ID of a file in the SLINGR app and you should send it instead of `file_data` as indicated in
MailChimp API. It returns the same as `POST /file-manager/files`.

For example:

```js
var res = app.endpoints.mailchimp.fileManager.files.post({
  file_id: record.field('file').id(), 
  name: 'test.png'
});
```

### Date helpers

MailChimp date use following format for dates `yyyy-MM-dd'T'HH:mm:ssX`. The following methods help to convert dates to
make it easy to work with SLINGR:

```js
// converts a Mailchimp date to milliseconds
var timestamp = app.endpoints.mailchimp.dates.toMillis('2017-07-19T13:12:56+00:00');

// converts a Mailchimp date to a Date object
var date = app.endpoints.mailchimp.dates.toDate('2017-07-19T13:12:56+00:00');

// converts milliseconds to a Mailchimp date
var mailchimpDate = app.endpoints.mailchimp.dates.fromMillis(1500469976000);

// converts a Date object to a Mailchimp date
var mailchimpDate = app.endpoints.mailchimp.dates.fromDate(new Date());
```

### Email helper

```
var md5 = app.endpoints.mailchimp.emailHash(email);
```

Returns the MD5 hash of the email. This is needed when you need to work with members in list.


## Events

### Webhook

Changes in lists like member subscriptions or unsubscriptions will be notified through this event. Keep in mind that you
need to configure webhooks on each list. See the documentation [here](http://kb.mailchimp.com/integrations/api-integrations/set-up-webhooks)
for more information.

According to the documentation of the [format of webhooks](http://developer.mailchimp.com/documentation/mailchimp/guides/about-webhooks/)
you should get key-value pairs like when there is an HTML form submission. However, to make it easier, we convert it to
JSON. For example, instead of getting this:

```
"type": "subscribe", 
"fired_at": "2009-03-26 21:35:57", 
"data[id]": "8a25ff1d98", 
"data[list_id]": "a6b5da1054",
"data[email]": "api@mailchimp.com", 
"data[email_type]": "html", 
"data[merges][EMAIL]": "api@mailchimp.com", 
"data[merges][FNAME]": "MailChimp", 
"data[merges][LNAME]": "API", 
"data[merges][INTERESTS]": "Group1,Group2", 
"data[ip_opt]": "10.20.10.30", 
"data[ip_signup]": "10.20.10.30"
```

You will get this:

```js
{
    type: "subscribe", 
    fired_at: "2009-03-26 21:35:57", 
    data: {
        id: "8a25ff1d98", 
        list_id: "a6b5da1054",
        email: "api@mailchimp.com", 
        email_type: "html", 
        merges: {
            EMAIL: "api@mailchimp.com", 
            FNAME: "MailChimp", 
            LNAME: "API", 
            INTERESTS: "Group1,Group2"
        },
        ip_opt: "10.20.10.30", 
        ip_signup: "10.20.10.30"
    }
}
```

## About SLINGR

SLINGR is a low-code rapid application development platform that accelerates development, with robust architecture for integrations and executing custom workflows and automation.

[More info about SLINGR](https://slingr.io)

## License

This endpoint is licensed under the Apache License 2.0. See the `LICENSE` file for more details.
